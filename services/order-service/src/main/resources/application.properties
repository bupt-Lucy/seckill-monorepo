# 1. 服务端口与应用名
server.port=${ORDER_SERVER_PORT:8081}
spring.application.name=${ORDER_APP_NAME:order-service}

# 2. Nacos 注册/发现
spring.cloud.nacos.discovery.server-addr=${NACOS_SERVER_ADDR:localhost:8848}
spring.cloud.nacos.discovery.ip=${NACOS_IP:localhost}

# 3. MySQL（不要明文）
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://${MYSQL_HOST:localhost}:${MYSQL_PORT:3306}/${MYSQL_DATABASE:seckill_db}?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai}
spring.datasource.username=${MYSQL_USER:root}
spring.datasource.password=${MYSQL_PASSWORD:123456}

spring.jpa.database-platform=${SPRING_JPA_DIALECT:org.hibernate.dialect.MySQL8Dialect}

# ================== RabbitMQ Configuration ==================
spring.rabbitmq.host=${RABBIT_HOST:localhost}
spring.rabbitmq.port=${RABBIT_PORT:5672}
spring.rabbitmq.username=${RABBIT_USER:guest}
spring.rabbitmq.password=${RABBIT_PASSWORD:guest}
spring.rabbitmq.listener.simple.acknowledge-mode=AUTO
spring.rabbitmq.listener.simple.retry.enabled=true
spring.rabbitmq.listener.simple.retry.max-attempts=${ORDER_RABBIT_MAX_ATTEMPTS:10}
spring.rabbitmq.listener.simple.retry.initial-interval=1s
spring.rabbitmq.listener.simple.retry.multiplier=2
spring.rabbitmq.listener.simple.retry.max-interval=30s

order.rabbitmq.exchange=${ORDER_RABBIT_EXCHANGE:seckill.exchange}
order.rabbitmq.queue=${ORDER_RABBIT_QUEUE:seckill.order.queue}
order.rabbitmq.routing-key=${ORDER_RABBIT_ROUTING_KEY:seckill.order.created}

# 4. Resilience4j (example preserved)
resilience4j.circuitbreaker.instances.dbWrite.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.dbWrite.minimum-number-of-calls=10
resilience4j.circuitbreaker.instances.dbWrite.sliding-window-type=COUNT_BASED
resilience4j.circuitbreaker.instances.dbWrite.sliding-window-size=10
resilience4j.circuitbreaker.instances.dbWrite.wait-duration-in-open-state=60s
resilience4j.circuitbreaker.instances.dbWrite.permitted-number-of-calls-in-half-open-state=2
resilience4j.circuitbreaker.instances.dbWrite.ignore-exceptions[0]=com.example.orderservice.exception.SeckillBusinessException

# 5. Actuator
management.endpoints.web.exposure.include=*
management.metrics.tags.application=${spring.application.name}
